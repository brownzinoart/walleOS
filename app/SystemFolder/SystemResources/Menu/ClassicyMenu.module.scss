@use 'sass:list';

@use '../../ControlPanels/AppearanceManager/styles/appearance';
@use '../../ControlPanels/AppearanceManager/styles/assets';

.classicyMenuWrapper {
  font-family: var(--ui-font);
  font-size: var(--ui-font-size);
  position: relative;
  z-index: 5000;
  display: flex;
  width: 100%;
  margin: 0;
  padding: 0;
  box-shadow: inset var(--window-border-size) var(--window-border-size) 0 0 var(--color-system-05),
  calc(var(--window-border-size) * 2) calc(var(--window-border-size) * 2) 0 0 var(--color-black);
}

.classicyMenu {
  position: absolute;
  display: flex;
  flex-direction: column;
  min-width: calc(var(--window-control-size) * 15);
  margin: 0;
  padding: var(--window-border-size);
  @include appearance.platinumWindowBorder;
  list-style: none;
  background-color: var(--color-system-02);
  background: linear-gradient(
    180deg,
    color-mix(in oklch, var(--color-system-02) 100%, transparent 0%) 0%,
    color-mix(in oklch, var(--color-system-02) 95%, var(--color-theme-07) 5%) 100%
  );
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5),
    0 0 15px color-mix(in oklch, var(--color-theme-03) 15%, transparent 85%),
    inset 0 1px 0 color-mix(in oklch, var(--color-system-05) 80%, var(--color-theme-03) 20%);
  border: 1px solid color-mix(in oklch, var(--color-black) 80%, var(--color-theme-03) 20%);

  hr {
    margin: calc(var(--window-control-size) / 2) calc(var(--window-border-size) * 2);
    border: none;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      color-mix(in oklch, var(--color-theme-03) 30%, var(--color-system-05) 70%) 50%,
      transparent 100%
    );
    box-shadow: 0 1px 0 color-mix(in oklch, var(--color-system-01) 80%, var(--color-theme-03) 20%);
  }

  div {
    ul {
      li {
        &:hover {
          color: #fff;
          background-color: var(--color-theme-04);

          * {
            display: flex !important;
          }
        }
      }
    }
  }
}

.classicySubMenu {
  position: absolute;
  display: none;
  flex-direction: column;
  min-width: calc(var(--window-control-size) * 15);
  @include appearance.platinumWindowBorder;
  margin: 0 0 0 calc(var(--window-padding-size) * -1);
  padding: var(--window-border-size);
  list-style: none;
  color: var(--color-black);
  background: var(--color-system-02);
  background-color: var(--color-system-02);
  background: linear-gradient(
    180deg,
    color-mix(in oklch, var(--color-system-02) 100%, transparent 0%) 0%,
    color-mix(in oklch, var(--color-system-02) 95%, var(--color-theme-07) 5%) 100%
  );
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5),
    0 0 15px color-mix(in oklch, var(--color-theme-03) 15%, transparent 85%),
    inset 0 1px 0 color-mix(in oklch, var(--color-system-05) 80%, var(--color-theme-03) 20%);
  border: 1px solid color-mix(in oklch, var(--color-black) 80%, var(--color-theme-03) 20%);
  background: linear-gradient(
    180deg,
    color-mix(in oklch, var(--color-system-02) 100%, transparent 0%) 0%,
    color-mix(in oklch, var(--color-system-02) 95%, var(--color-theme-07) 5%) 100%
  );
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5),
    0 0 15px color-mix(in oklch, var(--color-theme-03) 15%, transparent 85%),
    inset 0 1px 0 color-mix(in oklch, var(--color-system-05) 80%, var(--color-theme-03) 20%);
  border: 1px solid color-mix(in oklch, var(--color-black) 80%, var(--color-theme-03) 20%);

  hr {
    margin: calc(var(--window-control-size) / 2) calc(var(--window-border-size) * 2);
    border: none;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      color-mix(in oklch, var(--color-theme-03) 30%, var(--color-system-05) 70%) 50%,
      transparent 100%
    );
    box-shadow: 0 1px 0 color-mix(in oklch, var(--color-system-01) 80%, var(--color-theme-03) 20%);
  }
}

.classicyContextSubMenu {
  position: absolute;
  left: 100%;
  display: none;
  flex-direction: column;
  min-width: calc(var(--window-control-size) * 15);
  @include appearance.platinumWindowBorder;
  margin: calc(var(--window-padding-size) * -4) calc(var(--window-padding-size) * -2);
  padding: var(--window-border-size);
  list-style: none;
  color: var(--color-black);
  background: var(--color-system-02);
  background-color: var(--color-system-02);

  hr {
    margin: calc(var(--window-control-size) / 2) calc(var(--window-border-size) * 2);
    border: none;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      color-mix(in oklch, var(--color-theme-03) 30%, var(--color-system-05) 70%) 50%,
      transparent 100%
    );
    box-shadow: 0 1px 0 color-mix(in oklch, var(--color-system-01) 80%, var(--color-theme-03) 20%);
  }
}

.classicyMenuItem {
  display: flex;
  float: left;
  align-items: center;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: space-between;
  height: calc(100% - var(--window-padding-size)) !important;
  margin: 0;
  padding: calc(var(--window-padding-size) / 2) var(--window-padding-size);
  color: var(--color-white);
  transition: background-color 0.15s ease, color 0.15s ease, box-shadow 0.15s ease;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);

  &:hover {
    background: linear-gradient(
      90deg,
      color-mix(in oklch, var(--color-theme-03) 80%, var(--color-system-02) 20%) 0%,
      color-mix(in oklch, var(--color-theme-03) 70%, var(--color-system-02) 30%) 100%
    );
    color: var(--color-window-document);
    box-shadow: inset 0 0 20px color-mix(in oklch, var(--color-theme-03) 30%, transparent 70%),
      0 0 10px color-mix(in oklch, var(--color-theme-03) 20%, transparent 80%);
    text-shadow: 0 0 8px color-mix(in oklch, var(--color-theme-03) 40%, transparent 60%);

    div ul {
      display: flex !important;
    }
  }

  &:active {
    background: linear-gradient(
      90deg,
      color-mix(in oklch, var(--color-theme-04) 90%, var(--color-system-02) 10%) 0%,
      color-mix(in oklch, var(--color-theme-04) 80%, var(--color-system-02) 20%) 100%
    );
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.4),
      0 0 12px color-mix(in oklch, var(--color-theme-03) 30%, transparent 70%);
  }

  img {
    width: calc(var(--window-control-size) * 1.25);
    height: calc(var(--window-control-size) * 1.25);
    margin-right: calc(var(--window-control-size) * 0.5);
    user-select: none;
    user-drag: none;
  }

  p {
    display: flex;
    float: left;
    align-content: flex-start;
    align-items: center;
    margin: 0;
    padding: 0;

    a {
      cursor: default !important;
      text-decoration: none;
      color: inherit !important;
    }
  }
}

.classicyMenuItemNoImage {
  p {
    padding-left: calc(var(--window-control-size) * 1.75) !important;
  }
}

.classicyMenuItemDisabled {
  color: color-mix(in oklch, var(--color-system-05) 60%, var(--color-theme-07) 40%);
  opacity: 0.5;
  cursor: not-allowed;
  text-shadow: none;

  &:hover {
    background: transparent !important;
    box-shadow: none;
  }

  p {
    color: color-mix(in oklch, var(--color-system-05) 60%, var(--color-theme-07) 40%);
  }
}

.classicyMenuItemChildMenuIndicator {
  &:after {
    position: absolute;
    right: var(--window-control-size);
    width: 1em;
    height: 1em;
    content: ' ';
    background-image: assets.$triangle;
    background-repeat: no-repeat;
    background-position: right center;
    filter: drop-shadow(0 0 4px color-mix(in oklch, var(--color-theme-03) 15%, transparent 85%));
    transition: color 0.15s ease, filter 0.15s ease;
  }

  &:hover::after {
    filter: drop-shadow(0 0 8px color-mix(in oklch, var(--color-theme-03) 30%, transparent 70%));
  }
}

.classicyMenuItemKeyboardShortcut {
  font-size: 0.9em !important;
  line-height: 1.75;
  padding-right: calc(var(--window-padding-size) / 2) !important;
  color: color-mix(in oklch, var(--color-system-05) 80%, var(--color-theme-03) 20%);
  font-family: var(--ui-font);
  opacity: 0.8;
  transition: color 0.15s ease, opacity 0.15s ease;
}

.classicyMenuItem:hover .classicyMenuItemKeyboardShortcut {
  color: color-mix(in oklch, var(--color-window-document) 90%, var(--color-theme-03) 10%);
  opacity: 1;
}

.classicyMenuItemFlash {
  -webkit-animation-name: classicyMenuItemFlashKeyframes;
  animation-name: classicyMenuItemFlashKeyframes;
  animation-duration: 1s;
  animation-iteration-count: 1;
}

@keyframes classicyMenuItemFlashKeyframes {
  0% { filter: invert(100%);}
  20% { filter: invert(0);}
  40% { filter: invert(100%);}
  60% { filter: invert(0);}
  80% { filter: invert(100%);}
  100% { filter: invert(0);}
}
